import{S as X,i as Y}from"./split.es.435b128d.js";import Z from"./Preview.e7e9a80e.js";import{x as E,m,u as C,H as $,L as ee,p as oe,a1 as te,t as ae,w as S,b as L,E as re,o as k,F as T,G as ne,M as ie,N as le,c as se,Q as A,V as de}from"./entry.34beaa91.js";import{l as v,b as ue,j as pe,c as ce}from"./useFonts.08393901.js";import{v as me}from"./ModalCustomBackground.a7cd3208.js";import"./Hotkeys.2db21588.js";import"./Logo.a52106a7.js";import"./Dropdown.e79e16ca.js";import"./Window.5af67782.js";import"./FauxMenu.9aea156e.js";import"./Code.5ae399b1.js";import"./CodeLine.11de981f.js";import"./Canvas.092bd435.js";import"./ButtonResize.f71c70b2.js";import"./Divider.5c0ae6e6.js";import"./Separator.1c4aad71.js";import"./Interact.378af0ec.js";import"./ButtonLock.e6a22eea.js";import"./Label.0551d16c.js";import"./Range.418c2216.js";import"./ButtonBackground.d45b0cd6.js";import"./ButtonTheme.cf7e4c82.js";import"./useShiki.7e9e464a.js";import"./PopoverSettings.c9ed7a8b.js";import"./ButtonSettings.3b47bf61.js";import"./ControlRow.1e509d01.js";import"./Toggle.c559d6b1.js";import"./ToggleBorder.1a41921f.js";import"./ButtonColorPicker.fe203c0d.js";import"./ToggleShadow.a84dfb34.js";import"./ControlTabs.2d5910ba.js";import"./ControlTab.d6611262.js";import"./Dot.29ec27b8.js";import"./ButtonPlaceholder.ef07643f.js";import"./Modal.8d7c1851.js";function N(b=[],f){const d=E(null),e=m(()=>v.exports.castArray(C(b)).map(i=>C(i))),g=()=>e.value.map(i=>{var s;return(s=i==null?void 0:i.$el)!=null?s:i}),c=()=>{var i;(i=d.value)==null||i.destroy(),d.value=null},h=()=>{c(),e.value.length>1&&(d.value=X(g(),f.value))};return $(c),{init:h,destroy:c}}const ve={props:{project:{type:Object,required:!0}},setup(b,{emit:f}){const{$bus:d}=oe(),e=ue(),g=E([]),c=E(null),h=E(null),{width:i}=pe(),s=m(()=>i.value<=1024),a=te(v.exports.defaults(v.exports.cloneDeep(b.project.page),{editors:[],sizes:[40,60],editorSizes:[],previousOrientation:null,orientation:s.value?"top":"left"})),{sizes:r,editorSizes:z,editors:n,orientation:l,previousOrientation:w}=ae(a),j=m(()=>n.value.length>1);ce(document.body,()=>{var o;if(s.value)w.value=(o=w.value)!=null?o:l.value,l.value="top";else if(w.value){const t=w.value;w.value=null,l.value=t}});const{init:x}=N(g,m(()=>({gutterSize:5,sizes:z.value,onDrag:o=>z.value=o,direction:["top","bottom"].includes(l.value)?"horizontal":"vertical"}))),{init:D}=N([c,h],m(()=>({gutterSize:5,sizes:r.value,onDrag:o=>r.value=o,direction:["top","bottom"].includes(l.value)?"vertical":"horizontal"}))),F=()=>l.value={top:"left",bottom:"right",left:"top",right:"bottom"}[l.value],M=()=>l.value={top:"bottom",bottom:"top",left:"right",right:"left"}[l.value],U=o=>n.value.findIndex(t=>t.id===o),I=(o,t)=>{const u=n.value[o];n.value.splice(o,1),n.value.splice(t,0,u)},q=o=>{const t=U(o);I(t,t-1)},G=o=>{const t=U(o);I(t,t+1)},H=o=>{!j.value||(n.value.splice(U(o),1),d.$emit("editors:refresh"))},O=()=>{var t,u;const o=(u=(t=v.exports.last(n.value))==null?void 0:t.language)!=null?u:e.editorLanguage;return{id:me(),added:[],removed:[],focused:[],language:o,tabSize:e.editorTabSize,value:e.editorInitialValue}},P=()=>{n.value.length===0&&(l.value=s.value?"top":e.editorOrientation),n.value.push(O()),d.$emit("editors:refresh")},Q=o=>o.replace("<?php","").replace(/(\n*)/,""),W=m(()=>n.value.map(({id:o,language:t,value:u,added:y,removed:R,focused:V})=>{const B=e.stripIntialPhpTag&&t=="php";let K=B?Q(u):u,_=0;if(B){const p=u.replace("<?php","").match(/(\n+)/);p&&(_=p[0].split(/\n/g).length-1)}return{id:o,value:K,added:(y==null?void 0:y.map(p=>p-_))||[],removed:(R==null?void 0:R.map(p=>p-_))||[],focused:(V==null?void 0:V.map(p=>p-_))||[]}})),J=m(()=>n.value.map(({id:o,language:t})=>({id:o,name:t})));return S(a,v.exports.debounce(o=>f("update:page",o),5e3),{deep:!0}),S(g,o=>{z.value=v.exports.range(0,100,100/o.length).map(()=>100/o.length),x()}),S(l,()=>{L(D),L(x)}),S([l,z],()=>d.$emit("editors:refresh")),n.value=n.value.map(o=>v.exports.defaults(o,O())),re(async()=>{n.value.length===0&&P(),D(),x()}),{code:W,sizes:r,editors:n,addEditor:P,languages:J,editorRefs:g,orientation:l,moveEditorUp:q,moveEditorDown:G,removeEditor:H,toggleLayout:F,toggleReverse:M,findEditorIndex:U,canRemoveEditor:j,editorContainerRef:c,previewContainerRef:h}}};function fe(b,f,d,e,g,c){const h=Y,i=Z;return k(),T("div",{class:A(["flex flex-col justify-between flex-1 h-full overflow-hidden",{"lg:flex-row":e.orientation==="left","lg:flex-row-reverse":e.orientation==="right","lg:flex-col":e.orientation==="top","lg:flex-col-reverse":e.orientation==="bottom"}])},[ne("div",{dusk:"editors",ref:"editorContainerRef",class:A(["flex w-full h-full rounded-b-none",{"flex-col":["left","right"].includes(e.orientation),"divide-ui-gray-700 divide-x-4 flex-row":["top","bottom"].includes(e.orientation)}])},[(k(!0),T(ie,null,le(e.editors,(s,a)=>(k(),se(h,{dusk:"editor",ref_for:!0,ref:"editorRefs",class:"w-full h-full overflow-hidden",modelValue:e.editors[a].value,"onUpdate:modelValue":r=>e.editors[a].value=r,id:s.id,key:a,sizes:e.sizes,orientation:e.orientation,"tab-size":s.tabSize,language:s.language,"can-move-up":a!==0,"can-move-down":a!==e.editors.length-1,"can-remove":e.canRemoveEditor,"can-toggle-layout":a===0,added:e.editors[a].added,removed:e.editors[a].removed,focused:e.editors[a].focused,onAdd:e.addEditor,onRemove:e.removeEditor,onUp:e.moveEditorUp,onDown:e.moveEditorDown,"onUpdate:layout":e.toggleLayout,"onUpdate:reverse":e.toggleReverse,"onUpdate:tabSize":r=>e.editors[a].tabSize=r,"onUpdate:language":r=>e.editors[a].language=r,"onUpdate:added":r=>e.editors[a].added=r,"onUpdate:removed":r=>e.editors[a].removed=r,"onUpdate:focused":r=>e.editors[a].focused=r},null,8,["modelValue","onUpdate:modelValue","id","sizes","orientation","tab-size","language","can-move-up","can-move-down","can-remove","can-toggle-layout","added","removed","focused","onAdd","onRemove","onUp","onDown","onUpdate:layout","onUpdate:reverse","onUpdate:tabSize","onUpdate:language","onUpdate:added","onUpdate:removed","onUpdate:focused"]))),128))],2),de(i,{dusk:"preview",ref:"previewContainerRef",code:e.code,languages:e.languages,name:d.project.tab.name,defaults:d.project.settings,class:"overflow-auto scrollbar-hide","onUpdate:settings":f[0]||(f[0]=s=>b.$emit("update:settings",s))},null,8,["code","languages","name","defaults"])],2)}const Ye=ee(ve,[["render",fe]]);export{Ye as default};
